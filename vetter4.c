#define BUFSIZE 1024

#include "nibble.h"

static const unsigned long long counting_table[16 * 16] = {
    0x2,                0x11,               0x101,
    0x1001,             0x10001,            0x100001,
    0x1000001,          0x10000001,         0x100000001,
    0x1000000001,       0x10000000001,      0x100000000001,
    0x1000000000001,    0x10000000000001,   0x100000000000001,
    0x1000000000000001, 0x11,               0x20,
    0x110,              0x1010,             0x10010,
    0x100010,           0x1000010,          0x10000010,
    0x100000010,        0x1000000010,       0x10000000010,
    0x100000000010,     0x1000000000010,    0x10000000000010,
    0x100000000000010,  0x1000000000000010, 0x101,
    0x110,              0x200,              0x1100,
    0x10100,            0x100100,           0x1000100,
    0x10000100,         0x100000100,        0x1000000100,
    0x10000000100,      0x100000000100,     0x1000000000100,
    0x10000000000100,   0x100000000000100,  0x1000000000000100,
    0x1001,             0x1010,             0x1100,
    0x2000,             0x11000,            0x101000,
    0x1001000,          0x10001000,         0x100001000,
    0x1000001000,       0x10000001000,      0x100000001000,
    0x1000000001000,    0x10000000001000,   0x100000000001000,
    0x1000000000001000, 0x10001,            0x10010,
    0x10100,            0x11000,            0x20000,
    0x110000,           0x1010000,          0x10010000,
    0x100010000,        0x1000010000,       0x10000010000,
    0x100000010000,     0x1000000010000,    0x10000000010000,
    0x100000000010000,  0x1000000000010000, 0x100001,
    0x100010,           0x100100,           0x101000,
    0x110000,           0x200000,           0x1100000,
    0x10100000,         0x100100000,        0x1000100000,
    0x10000100000,      0x100000100000,     0x1000000100000,
    0x10000000100000,   0x100000000100000,  0x1000000000100000,
    0x1000001,          0x1000010,          0x1000100,
    0x1001000,          0x1010000,          0x1100000,
    0x2000000,          0x11000000,         0x101000000,
    0x1001000000,       0x10001000000,      0x100001000000,
    0x1000001000000,    0x10000001000000,   0x100000001000000,
    0x1000000001000000, 0x10000001,         0x10000010,
    0x10000100,         0x10001000,         0x10010000,
    0x10100000,         0x11000000,         0x20000000,
    0x110000000,        0x1010000000,       0x10010000000,
    0x100010000000,     0x1000010000000,    0x10000010000000,
    0x100000010000000,  0x1000000010000000, 0x100000001,
    0x100000010,        0x100000100,        0x100001000,
    0x100010000,        0x100100000,        0x101000000,
    0x110000000,        0x200000000,        0x1100000000,
    0x10100000000,      0x100100000000,     0x1000100000000,
    0x10000100000000,   0x100000100000000,  0x1000000100000000,
    0x1000000001,       0x1000000010,       0x1000000100,
    0x1000001000,       0x1000010000,       0x1000100000,
    0x1001000000,       0x1010000000,       0x1100000000,
    0x2000000000,       0x11000000000,      0x101000000000,
    0x1001000000000,    0x10001000000000,   0x100001000000000,
    0x1000001000000000, 0x10000000001,      0x10000000010,
    0x10000000100,      0x10000001000,      0x10000010000,
    0x10000100000,      0x10001000000,      0x10010000000,
    0x10100000000,      0x11000000000,      0x20000000000,
    0x110000000000,     0x1010000000000,    0x10010000000000,
    0x100010000000000,  0x1000010000000000, 0x100000000001,
    0x100000000010,     0x100000000100,     0x100000001000,
    0x100000010000,     0x100000100000,     0x100001000000,
    0x100010000000,     0x100100000000,     0x101000000000,
    0x110000000000,     0x200000000000,     0x1100000000000,
    0x10100000000000,   0x100100000000000,  0x1000100000000000,
    0x1000000000001,    0x1000000000010,    0x1000000000100,
    0x1000000001000,    0x1000000010000,    0x1000000100000,
    0x1000001000000,    0x1000010000000,    0x1000100000000,
    0x1001000000000,    0x1010000000000,    0x1100000000000,
    0x2000000000000,    0x11000000000000,   0x101000000000000,
    0x1001000000000000, 0x10000000000001,   0x10000000000010,
    0x10000000000100,   0x10000000001000,   0x10000000010000,
    0x10000000100000,   0x10000001000000,   0x10000010000000,
    0x10000100000000,   0x10001000000000,   0x10010000000000,
    0x10100000000000,   0x11000000000000,   0x20000000000000,
    0x110000000000000,  0x1010000000000000, 0x100000000000001,
    0x100000000000010,  0x100000000000100,  0x100000000001000,
    0x100000000010000,  0x100000000100000,  0x100000001000000,
    0x100000010000000,  0x100000100000000,  0x100001000000000,
    0x100010000000000,  0x100100000000000,  0x101000000000000,
    0x110000000000000,  0x200000000000000,  0x1100000000000000,
    0x1000000000000001, 0x1000000000000010, 0x1000000000000100,
    0x1000000000001000, 0x1000000000010000, 0x1000000000100000,
    0x1000000001000000, 0x1000000010000000, 0x1000000100000000,
    0x1000001000000000, 0x1000010000000000, 0x1000100000000000,
    0x1001000000000000, 0x1010000000000000, 0x1100000000000000,
    0x2000000000000000,
};

static const unsigned long long result_table[16 * 16 * 8] = {
    0x0,                0xe,                0xee,
    0xeee,              0xeeee,             0xeeeee,
    0xeeeeee,           0xeeeeeee,          0xeeeeeeee,
    0xeeeeeeeee,        0xeeeeeeeeee,       0xeeeeeeeeeee,
    0xeeeeeeeeeeee,     0xeeeeeeeeeeeee,    0xeeeeeeeeeeeeee,
    0xeeeeeeeeeeeeeee,  0xf,                0xfe,
    0xfee,              0xfeee,             0xfeeee,
    0xfeeeee,           0xfeeeeee,          0xfeeeeeee,
    0xfeeeeeeee,        0xfeeeeeeeee,       0xfeeeeeeeeee,
    0xfeeeeeeeeeee,     0xfeeeeeeeeeeee,    0xfeeeeeeeeeeeee,
    0xfeeeeeeeeeeeeee,  0xfeeeeeeeeeeeeeee, 0xff,
    0xffe,              0xffee,             0xffeee,
    0xffeeee,           0xffeeeee,          0xffeeeeee,
    0xffeeeeeee,        0xffeeeeeeee,       0xffeeeeeeeee,
    0xffeeeeeeeeee,     0xffeeeeeeeeeee,    0xffeeeeeeeeeeee,
    0xffeeeeeeeeeeeee,  0xffeeeeeeeeeeeeee, 0x0,
    0xfff,              0xfffe,             0xfffee,
    0xfffeee,           0xfffeeee,          0xfffeeeee,
    0xfffeeeeee,        0xfffeeeeeee,       0xfffeeeeeeee,
    0xfffeeeeeeeee,     0xfffeeeeeeeeee,    0xfffeeeeeeeeeee,
    0xfffeeeeeeeeeeee,  0xfffeeeeeeeeeeeee, 0x0,
    0x0,                0xffff,             0xffffe,
    0xffffee,           0xffffeee,          0xffffeeee,
    0xffffeeeee,        0xffffeeeeee,       0xffffeeeeeee,
    0xffffeeeeeeee,     0xffffeeeeeeeee,    0xffffeeeeeeeeee,
    0xffffeeeeeeeeeee,  0xffffeeeeeeeeeeee, 0x0,
    0x0,                0x0,                0xfffff,
    0xfffffe,           0xfffffee,          0xfffffeee,
    0xfffffeeee,        0xfffffeeeee,       0xfffffeeeeee,
    0xfffffeeeeeee,     0xfffffeeeeeeee,    0xfffffeeeeeeeee,
    0xfffffeeeeeeeeee,  0xfffffeeeeeeeeeee, 0x0,
    0x0,                0x0,                0x0,
    0xffffff,           0xffffffe,          0xffffffee,
    0xffffffeee,        0xffffffeeee,       0xffffffeeeee,
    0xffffffeeeeee,     0xffffffeeeeeee,    0xffffffeeeeeeee,
    0xffffffeeeeeeeee,  0xffffffeeeeeeeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0xfffffff,          0xfffffffe,
    0xfffffffee,        0xfffffffeee,       0xfffffffeeee,
    0xfffffffeeeee,     0xfffffffeeeeee,    0xfffffffeeeeeee,
    0xfffffffeeeeeeee,  0xfffffffeeeeeeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xffffffff,
    0xffffffffe,        0xffffffffee,       0xffffffffeee,
    0xffffffffeeee,     0xffffffffeeeee,    0xffffffffeeeeee,
    0xffffffffeeeeeee,  0xffffffffeeeeeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xfffffffff,        0xfffffffffe,       0xfffffffffee,
    0xfffffffffeee,     0xfffffffffeeee,    0xfffffffffeeeee,
    0xfffffffffeeeeee,  0xfffffffffeeeeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xffffffffff,       0xffffffffffe,
    0xffffffffffee,     0xffffffffffeee,    0xffffffffffeeee,
    0xffffffffffeeeee,  0xffffffffffeeeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xfffffffffff,
    0xfffffffffffe,     0xfffffffffffee,    0xfffffffffffeee,
    0xfffffffffffeeee,  0xfffffffffffeeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xffffffffffff,     0xffffffffffffe,    0xffffffffffffee,
    0xffffffffffffeee,  0xffffffffffffeeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xfffffffffffff,    0xfffffffffffffe,
    0xfffffffffffffee,  0xfffffffffffffeee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xffffffffffffff,
    0xffffffffffffffe,  0xffffffffffffffee, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xfffffffffffffff,  0xfffffffffffffffe, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xc,
    0xcc,               0xccc,              0xcccc,
    0xccccc,            0xcccccc,           0xccccccc,
    0xcccccccc,         0xccccccccc,        0xcccccccccc,
    0xccccccccccc,      0xcccccccccccc,     0xccccccccccccc,
    0xcccccccccccccc,   0xccccccccccccccc,  0xd,
    0xdc,               0xdcc,              0xdccc,
    0xdcccc,            0xdccccc,           0xdcccccc,
    0xdccccccc,         0xdcccccccc,        0xdccccccccc,
    0xdcccccccccc,      0xdccccccccccc,     0xdcccccccccccc,
    0xdccccccccccccc,   0xdcccccccccccccc,  0xdccccccccccccccc,
    0xdd,               0xddc,              0xddcc,
    0xddccc,            0xddcccc,           0xddccccc,
    0xddcccccc,         0xddccccccc,        0xddcccccccc,
    0xddccccccccc,      0xddcccccccccc,     0xddccccccccccc,
    0xddcccccccccccc,   0xddccccccccccccc,  0xddcccccccccccccc,
    0x0,                0xddd,              0xdddc,
    0xdddcc,            0xdddccc,           0xdddcccc,
    0xdddccccc,         0xdddcccccc,        0xdddccccccc,
    0xdddcccccccc,      0xdddccccccccc,     0xdddcccccccccc,
    0xdddccccccccccc,   0xdddcccccccccccc,  0xdddccccccccccccc,
    0x0,                0x0,                0xdddd,
    0xddddc,            0xddddcc,           0xddddccc,
    0xddddcccc,         0xddddccccc,        0xddddcccccc,
    0xddddccccccc,      0xddddcccccccc,     0xddddccccccccc,
    0xddddcccccccccc,   0xddddccccccccccc,  0xddddcccccccccccc,
    0x0,                0x0,                0x0,
    0xddddd,            0xdddddc,           0xdddddcc,
    0xdddddccc,         0xdddddcccc,        0xdddddccccc,
    0xdddddcccccc,      0xdddddccccccc,     0xdddddcccccccc,
    0xdddddccccccccc,   0xdddddcccccccccc,  0xdddddccccccccccc,
    0x0,                0x0,                0x0,
    0x0,                0xdddddd,           0xddddddc,
    0xddddddcc,         0xddddddccc,        0xddddddcccc,
    0xddddddccccc,      0xddddddcccccc,     0xddddddccccccc,
    0xddddddcccccccc,   0xddddddccccccccc,  0xddddddcccccccccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xddddddd,
    0xdddddddc,         0xdddddddcc,        0xdddddddccc,
    0xdddddddcccc,      0xdddddddccccc,     0xdddddddcccccc,
    0xdddddddccccccc,   0xdddddddcccccccc,  0xdddddddccccccccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xdddddddd,         0xddddddddc,        0xddddddddcc,
    0xddddddddccc,      0xddddddddcccc,     0xddddddddccccc,
    0xddddddddcccccc,   0xddddddddccccccc,  0xddddddddcccccccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xddddddddd,        0xdddddddddc,
    0xdddddddddcc,      0xdddddddddccc,     0xdddddddddcccc,
    0xdddddddddccccc,   0xdddddddddcccccc,  0xdddddddddccccccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xdddddddddd,
    0xddddddddddc,      0xddddddddddcc,     0xddddddddddccc,
    0xddddddddddcccc,   0xddddddddddccccc,  0xddddddddddcccccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xddddddddddd,      0xdddddddddddc,     0xdddddddddddcc,
    0xdddddddddddccc,   0xdddddddddddcccc,  0xdddddddddddccccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xdddddddddddd,     0xddddddddddddc,
    0xddddddddddddcc,   0xddddddddddddccc,  0xddddddddddddcccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xddddddddddddd,
    0xdddddddddddddc,   0xdddddddddddddcc,  0xdddddddddddddccc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xdddddddddddddd,   0xddddddddddddddc,  0xddddddddddddddcc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xddddddddddddddd,  0xdddddddddddddddc,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xa,                0xaa,               0xaaa,
    0xaaaa,             0xaaaaa,            0xaaaaaa,
    0xaaaaaaa,          0xaaaaaaaa,         0xaaaaaaaaa,
    0xaaaaaaaaaa,       0xaaaaaaaaaaa,      0xaaaaaaaaaaaa,
    0xaaaaaaaaaaaaa,    0xaaaaaaaaaaaaaa,   0xaaaaaaaaaaaaaaa,
    0xb,                0xba,               0xbaa,
    0xbaaa,             0xbaaaa,            0xbaaaaa,
    0xbaaaaaa,          0xbaaaaaaa,         0xbaaaaaaaa,
    0xbaaaaaaaaa,       0xbaaaaaaaaaa,      0xbaaaaaaaaaaa,
    0xbaaaaaaaaaaaa,    0xbaaaaaaaaaaaaa,   0xbaaaaaaaaaaaaaa,
    0xbaaaaaaaaaaaaaaa, 0xbb,               0xbba,
    0xbbaa,             0xbbaaa,            0xbbaaaa,
    0xbbaaaaa,          0xbbaaaaaa,         0xbbaaaaaaa,
    0xbbaaaaaaaa,       0xbbaaaaaaaaa,      0xbbaaaaaaaaaa,
    0xbbaaaaaaaaaaa,    0xbbaaaaaaaaaaaa,   0xbbaaaaaaaaaaaaa,
    0xbbaaaaaaaaaaaaaa, 0x0,                0xbbb,
    0xbbba,             0xbbbaa,            0xbbbaaa,
    0xbbbaaaa,          0xbbbaaaaa,         0xbbbaaaaaa,
    0xbbbaaaaaaa,       0xbbbaaaaaaaa,      0xbbbaaaaaaaaa,
    0xbbbaaaaaaaaaa,    0xbbbaaaaaaaaaaa,   0xbbbaaaaaaaaaaaa,
    0xbbbaaaaaaaaaaaaa, 0x0,                0x0,
    0xbbbb,             0xbbbba,            0xbbbbaa,
    0xbbbbaaa,          0xbbbbaaaa,         0xbbbbaaaaa,
    0xbbbbaaaaaa,       0xbbbbaaaaaaa,      0xbbbbaaaaaaaa,
    0xbbbbaaaaaaaaa,    0xbbbbaaaaaaaaaa,   0xbbbbaaaaaaaaaaa,
    0xbbbbaaaaaaaaaaaa, 0x0,                0x0,
    0x0,                0xbbbbb,            0xbbbbba,
    0xbbbbbaa,          0xbbbbbaaa,         0xbbbbbaaaa,
    0xbbbbbaaaaa,       0xbbbbbaaaaaa,      0xbbbbbaaaaaaa,
    0xbbbbbaaaaaaaa,    0xbbbbbaaaaaaaaa,   0xbbbbbaaaaaaaaaa,
    0xbbbbbaaaaaaaaaaa, 0x0,                0x0,
    0x0,                0x0,                0xbbbbbb,
    0xbbbbbba,          0xbbbbbbaa,         0xbbbbbbaaa,
    0xbbbbbbaaaa,       0xbbbbbbaaaaa,      0xbbbbbbaaaaaa,
    0xbbbbbbaaaaaaa,    0xbbbbbbaaaaaaaa,   0xbbbbbbaaaaaaaaa,
    0xbbbbbbaaaaaaaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0xbbbbbbb,          0xbbbbbbba,         0xbbbbbbbaa,
    0xbbbbbbbaaa,       0xbbbbbbbaaaa,      0xbbbbbbbaaaaa,
    0xbbbbbbbaaaaaa,    0xbbbbbbbaaaaaaa,   0xbbbbbbbaaaaaaaa,
    0xbbbbbbbaaaaaaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xbbbbbbbb,         0xbbbbbbbba,
    0xbbbbbbbbaa,       0xbbbbbbbbaaa,      0xbbbbbbbbaaaa,
    0xbbbbbbbbaaaaa,    0xbbbbbbbbaaaaaa,   0xbbbbbbbbaaaaaaa,
    0xbbbbbbbbaaaaaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xbbbbbbbbb,
    0xbbbbbbbbba,       0xbbbbbbbbbaa,      0xbbbbbbbbbaaa,
    0xbbbbbbbbbaaaa,    0xbbbbbbbbbaaaaa,   0xbbbbbbbbbaaaaaa,
    0xbbbbbbbbbaaaaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xbbbbbbbbbb,       0xbbbbbbbbbba,      0xbbbbbbbbbbaa,
    0xbbbbbbbbbbaaa,    0xbbbbbbbbbbaaaa,   0xbbbbbbbbbbaaaaa,
    0xbbbbbbbbbbaaaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xbbbbbbbbbbb,      0xbbbbbbbbbbba,
    0xbbbbbbbbbbbaa,    0xbbbbbbbbbbbaaa,   0xbbbbbbbbbbbaaaa,
    0xbbbbbbbbbbbaaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xbbbbbbbbbbbb,
    0xbbbbbbbbbbbba,    0xbbbbbbbbbbbbaa,   0xbbbbbbbbbbbbaaa,
    0xbbbbbbbbbbbbaaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0xbbbbbbbbbbbbb,    0xbbbbbbbbbbbbba,   0xbbbbbbbbbbbbbaa,
    0xbbbbbbbbbbbbbaaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0xbbbbbbbbbbbbbb,   0xbbbbbbbbbbbbbba,
    0xbbbbbbbbbbbbbbaa, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0xbbbbbbbbbbbbbbb,
    0xbbbbbbbbbbbbbbba, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x8,                0x88,
    0x888,              0x8888,             0x88888,
    0x888888,           0x8888888,          0x88888888,
    0x888888888,        0x8888888888,       0x88888888888,
    0x888888888888,     0x8888888888888,    0x88888888888888,
    0x888888888888888,  0x9,                0x98,
    0x988,              0x9888,             0x98888,
    0x988888,           0x9888888,          0x98888888,
    0x988888888,        0x9888888888,       0x98888888888,
    0x988888888888,     0x9888888888888,    0x98888888888888,
    0x988888888888888,  0x9888888888888888, 0x99,
    0x998,              0x9988,             0x99888,
    0x998888,           0x9988888,          0x99888888,
    0x998888888,        0x9988888888,       0x99888888888,
    0x998888888888,     0x9988888888888,    0x99888888888888,
    0x998888888888888,  0x9988888888888888, 0x0,
    0x999,              0x9998,             0x99988,
    0x999888,           0x9998888,          0x99988888,
    0x999888888,        0x9998888888,       0x99988888888,
    0x999888888888,     0x9998888888888,    0x99988888888888,
    0x999888888888888,  0x9998888888888888, 0x0,
    0x0,                0x9999,             0x99998,
    0x999988,           0x9999888,          0x99998888,
    0x999988888,        0x9999888888,       0x99998888888,
    0x999988888888,     0x9999888888888,    0x99998888888888,
    0x999988888888888,  0x9999888888888888, 0x0,
    0x0,                0x0,                0x99999,
    0x999998,           0x9999988,          0x99999888,
    0x999998888,        0x9999988888,       0x99999888888,
    0x999998888888,     0x9999988888888,    0x99999888888888,
    0x999998888888888,  0x9999988888888888, 0x0,
    0x0,                0x0,                0x0,
    0x999999,           0x9999998,          0x99999988,
    0x999999888,        0x9999998888,       0x99999988888,
    0x999999888888,     0x9999998888888,    0x99999988888888,
    0x999999888888888,  0x9999998888888888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x9999999,          0x99999998,
    0x999999988,        0x9999999888,       0x99999998888,
    0x999999988888,     0x9999999888888,    0x99999998888888,
    0x999999988888888,  0x9999999888888888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x99999999,
    0x999999998,        0x9999999988,       0x99999999888,
    0x999999998888,     0x9999999988888,    0x99999999888888,
    0x999999998888888,  0x9999999988888888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x999999999,        0x9999999998,       0x99999999988,
    0x999999999888,     0x9999999998888,    0x99999999988888,
    0x999999999888888,  0x9999999998888888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x9999999999,       0x99999999998,
    0x999999999988,     0x9999999999888,    0x99999999998888,
    0x999999999988888,  0x9999999999888888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x99999999999,
    0x999999999998,     0x9999999999988,    0x99999999999888,
    0x999999999998888,  0x9999999999988888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x999999999999,     0x9999999999998,    0x99999999999988,
    0x999999999999888,  0x9999999999998888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x9999999999999,    0x99999999999998,
    0x999999999999988,  0x9999999999999888, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x99999999999999,
    0x999999999999998,  0x9999999999999988, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x999999999999999,  0x9999999999999998, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x6,
    0x66,               0x666,              0x6666,
    0x66666,            0x666666,           0x6666666,
    0x66666666,         0x666666666,        0x6666666666,
    0x66666666666,      0x666666666666,     0x6666666666666,
    0x66666666666666,   0x666666666666666,  0x7,
    0x76,               0x766,              0x7666,
    0x76666,            0x766666,           0x7666666,
    0x76666666,         0x766666666,        0x7666666666,
    0x76666666666,      0x766666666666,     0x7666666666666,
    0x76666666666666,   0x766666666666666,  0x7666666666666666,
    0x77,               0x776,              0x7766,
    0x77666,            0x776666,           0x7766666,
    0x77666666,         0x776666666,        0x7766666666,
    0x77666666666,      0x776666666666,     0x7766666666666,
    0x77666666666666,   0x776666666666666,  0x7766666666666666,
    0x0,                0x777,              0x7776,
    0x77766,            0x777666,           0x7776666,
    0x77766666,         0x777666666,        0x7776666666,
    0x77766666666,      0x777666666666,     0x7776666666666,
    0x77766666666666,   0x777666666666666,  0x7776666666666666,
    0x0,                0x0,                0x7777,
    0x77776,            0x777766,           0x7777666,
    0x77776666,         0x777766666,        0x7777666666,
    0x77776666666,      0x777766666666,     0x7777666666666,
    0x77776666666666,   0x777766666666666,  0x7777666666666666,
    0x0,                0x0,                0x0,
    0x77777,            0x777776,           0x7777766,
    0x77777666,         0x777776666,        0x7777766666,
    0x77777666666,      0x777776666666,     0x7777766666666,
    0x77777666666666,   0x777776666666666,  0x7777766666666666,
    0x0,                0x0,                0x0,
    0x0,                0x777777,           0x7777776,
    0x77777766,         0x777777666,        0x7777776666,
    0x77777766666,      0x777777666666,     0x7777776666666,
    0x77777766666666,   0x777777666666666,  0x7777776666666666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x7777777,
    0x77777776,         0x777777766,        0x7777777666,
    0x77777776666,      0x777777766666,     0x7777777666666,
    0x77777776666666,   0x777777766666666,  0x7777777666666666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x77777777,         0x777777776,        0x7777777766,
    0x77777777666,      0x777777776666,     0x7777777766666,
    0x77777777666666,   0x777777776666666,  0x7777777766666666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x777777777,        0x7777777776,
    0x77777777766,      0x777777777666,     0x7777777776666,
    0x77777777766666,   0x777777777666666,  0x7777777776666666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x7777777777,
    0x77777777776,      0x777777777766,     0x7777777777666,
    0x77777777776666,   0x777777777766666,  0x7777777777666666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x77777777777,      0x777777777776,     0x7777777777766,
    0x77777777777666,   0x777777777776666,  0x7777777777766666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x777777777777,     0x7777777777776,
    0x77777777777766,   0x777777777777666,  0x7777777777776666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x7777777777777,
    0x77777777777776,   0x777777777777766,  0x7777777777777666,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x77777777777777,   0x777777777777776,  0x7777777777777766,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x777777777777777,  0x7777777777777776,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x4,                0x44,               0x444,
    0x4444,             0x44444,            0x444444,
    0x4444444,          0x44444444,         0x444444444,
    0x4444444444,       0x44444444444,      0x444444444444,
    0x4444444444444,    0x44444444444444,   0x444444444444444,
    0x5,                0x54,               0x544,
    0x5444,             0x54444,            0x544444,
    0x5444444,          0x54444444,         0x544444444,
    0x5444444444,       0x54444444444,      0x544444444444,
    0x5444444444444,    0x54444444444444,   0x544444444444444,
    0x5444444444444444, 0x55,               0x554,
    0x5544,             0x55444,            0x554444,
    0x5544444,          0x55444444,         0x554444444,
    0x5544444444,       0x55444444444,      0x554444444444,
    0x5544444444444,    0x55444444444444,   0x554444444444444,
    0x5544444444444444, 0x0,                0x555,
    0x5554,             0x55544,            0x555444,
    0x5554444,          0x55544444,         0x555444444,
    0x5554444444,       0x55544444444,      0x555444444444,
    0x5554444444444,    0x55544444444444,   0x555444444444444,
    0x5554444444444444, 0x0,                0x0,
    0x5555,             0x55554,            0x555544,
    0x5555444,          0x55554444,         0x555544444,
    0x5555444444,       0x55554444444,      0x555544444444,
    0x5555444444444,    0x55554444444444,   0x555544444444444,
    0x5555444444444444, 0x0,                0x0,
    0x0,                0x55555,            0x555554,
    0x5555544,          0x55555444,         0x555554444,
    0x5555544444,       0x55555444444,      0x555554444444,
    0x5555544444444,    0x55555444444444,   0x555554444444444,
    0x5555544444444444, 0x0,                0x0,
    0x0,                0x0,                0x555555,
    0x5555554,          0x55555544,         0x555555444,
    0x5555554444,       0x55555544444,      0x555555444444,
    0x5555554444444,    0x55555544444444,   0x555555444444444,
    0x5555554444444444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x5555555,          0x55555554,         0x555555544,
    0x5555555444,       0x55555554444,      0x555555544444,
    0x5555555444444,    0x55555554444444,   0x555555544444444,
    0x5555555444444444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x55555555,         0x555555554,
    0x5555555544,       0x55555555444,      0x555555554444,
    0x5555555544444,    0x55555555444444,   0x555555554444444,
    0x5555555544444444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x555555555,
    0x5555555554,       0x55555555544,      0x555555555444,
    0x5555555554444,    0x55555555544444,   0x555555555444444,
    0x5555555554444444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x5555555555,       0x55555555554,      0x555555555544,
    0x5555555555444,    0x55555555554444,   0x555555555544444,
    0x5555555555444444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x55555555555,      0x555555555554,
    0x5555555555544,    0x55555555555444,   0x555555555554444,
    0x5555555555544444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x555555555555,
    0x5555555555554,    0x55555555555544,   0x555555555555444,
    0x5555555555554444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x5555555555555,    0x55555555555554,   0x555555555555544,
    0x5555555555555444, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x55555555555555,   0x555555555555554,
    0x5555555555555544, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x555555555555555,
    0x5555555555555554, 0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x2,                0x22,
    0x222,              0x2222,             0x22222,
    0x222222,           0x2222222,          0x22222222,
    0x222222222,        0x2222222222,       0x22222222222,
    0x222222222222,     0x2222222222222,    0x22222222222222,
    0x222222222222222,  0x3,                0x32,
    0x322,              0x3222,             0x32222,
    0x322222,           0x3222222,          0x32222222,
    0x322222222,        0x3222222222,       0x32222222222,
    0x322222222222,     0x3222222222222,    0x32222222222222,
    0x322222222222222,  0x3222222222222222, 0x33,
    0x332,              0x3322,             0x33222,
    0x332222,           0x3322222,          0x33222222,
    0x332222222,        0x3322222222,       0x33222222222,
    0x332222222222,     0x3322222222222,    0x33222222222222,
    0x332222222222222,  0x3322222222222222, 0x0,
    0x333,              0x3332,             0x33322,
    0x333222,           0x3332222,          0x33322222,
    0x333222222,        0x3332222222,       0x33322222222,
    0x333222222222,     0x3332222222222,    0x33322222222222,
    0x333222222222222,  0x3332222222222222, 0x0,
    0x0,                0x3333,             0x33332,
    0x333322,           0x3333222,          0x33332222,
    0x333322222,        0x3333222222,       0x33332222222,
    0x333322222222,     0x3333222222222,    0x33332222222222,
    0x333322222222222,  0x3333222222222222, 0x0,
    0x0,                0x0,                0x33333,
    0x333332,           0x3333322,          0x33333222,
    0x333332222,        0x3333322222,       0x33333222222,
    0x333332222222,     0x3333322222222,    0x33333222222222,
    0x333332222222222,  0x3333322222222222, 0x0,
    0x0,                0x0,                0x0,
    0x333333,           0x3333332,          0x33333322,
    0x333333222,        0x3333332222,       0x33333322222,
    0x333333222222,     0x3333332222222,    0x33333322222222,
    0x333333222222222,  0x3333332222222222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x3333333,          0x33333332,
    0x333333322,        0x3333333222,       0x33333332222,
    0x333333322222,     0x3333333222222,    0x33333332222222,
    0x333333322222222,  0x3333333222222222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x33333333,
    0x333333332,        0x3333333322,       0x33333333222,
    0x333333332222,     0x3333333322222,    0x33333333222222,
    0x333333332222222,  0x3333333322222222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x333333333,        0x3333333332,       0x33333333322,
    0x333333333222,     0x3333333332222,    0x33333333322222,
    0x333333333222222,  0x3333333332222222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x3333333333,       0x33333333332,
    0x333333333322,     0x3333333333222,    0x33333333332222,
    0x333333333322222,  0x3333333333222222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x33333333333,
    0x333333333332,     0x3333333333322,    0x33333333333222,
    0x333333333332222,  0x3333333333322222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x333333333333,     0x3333333333332,    0x33333333333322,
    0x333333333333222,  0x3333333333332222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x3333333333333,    0x33333333333332,
    0x333333333333322,  0x3333333333333222, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x33333333333333,
    0x333333333333332,  0x3333333333333322, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x333333333333333,  0x3333333333333332, 0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x1,
    0x10,               0x100,              0x1000,
    0x10000,            0x100000,           0x1000000,
    0x10000000,         0x100000000,        0x1000000000,
    0x10000000000,      0x100000000000,     0x1000000000000,
    0x10000000000000,   0x100000000000000,  0x1000000000000000,
    0x11,               0x110,              0x1100,
    0x11000,            0x110000,           0x1100000,
    0x11000000,         0x110000000,        0x1100000000,
    0x11000000000,      0x110000000000,     0x1100000000000,
    0x11000000000000,   0x110000000000000,  0x1100000000000000,
    0x0,                0x111,              0x1110,
    0x11100,            0x111000,           0x1110000,
    0x11100000,         0x111000000,        0x1110000000,
    0x11100000000,      0x111000000000,     0x1110000000000,
    0x11100000000000,   0x111000000000000,  0x1110000000000000,
    0x0,                0x0,                0x1111,
    0x11110,            0x111100,           0x1111000,
    0x11110000,         0x111100000,        0x1111000000,
    0x11110000000,      0x111100000000,     0x1111000000000,
    0x11110000000000,   0x111100000000000,  0x1111000000000000,
    0x0,                0x0,                0x0,
    0x11111,            0x111110,           0x1111100,
    0x11111000,         0x111110000,        0x1111100000,
    0x11111000000,      0x111110000000,     0x1111100000000,
    0x11111000000000,   0x111110000000000,  0x1111100000000000,
    0x0,                0x0,                0x0,
    0x0,                0x111111,           0x1111110,
    0x11111100,         0x111111000,        0x1111110000,
    0x11111100000,      0x111111000000,     0x1111110000000,
    0x11111100000000,   0x111111000000000,  0x1111110000000000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x1111111,
    0x11111110,         0x111111100,        0x1111111000,
    0x11111110000,      0x111111100000,     0x1111111000000,
    0x11111110000000,   0x111111100000000,  0x1111111000000000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x11111111,         0x111111110,        0x1111111100,
    0x11111111000,      0x111111110000,     0x1111111100000,
    0x11111111000000,   0x111111110000000,  0x1111111100000000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x111111111,        0x1111111110,
    0x11111111100,      0x111111111000,     0x1111111110000,
    0x11111111100000,   0x111111111000000,  0x1111111110000000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x1111111111,
    0x11111111110,      0x111111111100,     0x1111111111000,
    0x11111111110000,   0x111111111100000,  0x1111111111000000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x11111111111,      0x111111111110,     0x1111111111100,
    0x11111111111000,   0x111111111110000,  0x1111111111100000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x111111111111,     0x1111111111110,
    0x11111111111100,   0x111111111111000,  0x1111111111110000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x1111111111111,
    0x11111111111110,   0x111111111111100,  0x1111111111111000,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x11111111111111,   0x111111111111110,  0x1111111111111100,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x111111111111111,  0x1111111111111110,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,                0x0,
    0x0,                0x0,
};

static const unsigned char shifting_table[16 * 16] = {
    0x0,  0x4,  0x8,  0xc,  0x10, 0x14, 0x18, 0x1c, 0x20, 0x24, 0x28, 0x2c,
    0x30, 0x34, 0x38, 0x3c, 0x4,  0x8,  0xc,  0x10, 0x14, 0x18, 0x1c, 0x20,
    0x24, 0x28, 0x2c, 0x30, 0x34, 0x38, 0x3c, 0x40, 0x8,  0xc,  0x10, 0x14,
    0x18, 0x1c, 0x20, 0x24, 0x28, 0x2c, 0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,
    0xc,  0x10, 0x14, 0x18, 0x1c, 0x20, 0x24, 0x28, 0x2c, 0x30, 0x34, 0x38,
    0x3c, 0x40, 0x0,  0x0,  0x10, 0x14, 0x18, 0x1c, 0x20, 0x24, 0x28, 0x2c,
    0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,  0x0,  0x0,  0x14, 0x18, 0x1c, 0x20,
    0x24, 0x28, 0x2c, 0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,
    0x18, 0x1c, 0x20, 0x24, 0x28, 0x2c, 0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,
    0x0,  0x0,  0x0,  0x0,  0x1c, 0x20, 0x24, 0x28, 0x2c, 0x30, 0x34, 0x38,
    0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x20, 0x24, 0x28, 0x2c,
    0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,
    0x24, 0x28, 0x2c, 0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,
    0x0,  0x0,  0x0,  0x0,  0x28, 0x2c, 0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,
    0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x2c, 0x30, 0x34, 0x38,
    0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,
    0x30, 0x34, 0x38, 0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,
    0x0,  0x0,  0x0,  0x0,  0x34, 0x38, 0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,
    0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x38, 0x3c, 0x40, 0x0,
    0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,
    0x3c, 0x40, 0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,
    0x0,  0x0,  0x0,  0x0,
};

void nibble_sort_vetter4(unsigned long long *buf) {
  /*
  printf("static const unsigned long long counting_table[16 * 16] =\n{\n");
  for ( int i = 0; i < 16; i++) {
      for (int j = 0; j < 16; j++)
          printf("0x%llx,", (1ULL << (4 * i)) + (1ULL << (4 * j)));
      printf("\n");
  }
  printf("};\n\n");
  printf("static const unsigned long long result_table[16 * 16 * 8] =\n{\n");
  for ( int i = 0; i < 16; i+=2) {
      for (int j = 0; j < 16; j++) {
          int shift1 = j * 4;
          unsigned long long data1 = (0x1111111111111111ULL * (0xF - i));
          for (int k = 0; k < 16; k++) {
              int shift2 = k * 4;
              unsigned long long data2 = (0x1111111111111111ULL * (0xF - i -
  1));
              if (k + j > 16)
                  printf("0x0,");
              else
                  printf("0x%llx,", ((data1 ^ (data1 << shift1)) << shift2) ^
  (data2 << shift2) ^ data2);
          }
          printf("\n");
      }
  }
  printf("};\n\n");
  printf("static const unsigned char shifting_table[16 *16] =\n{\n");
  for ( int i = 0; i < 16; i++) {
      for (int j = 0; j < 16; j++) {
          if (i + j > 16)
              printf("0x0,");
          else
              printf("0x%llx,", 4*(i + j));
      }
      printf("\n");
  }
  printf("};\n\n");
  return;
  */
  for (int num = 0; num < BUFSIZE; num++) {
    unsigned long long value = buf[num];
    unsigned long long count = 0;
    for (int i = 0; i < 16; i += 2)
      count += counting_table[(value >> (i * 4)) & 0xFF];

    if ((count & (count - 1)) == 0)
      continue;

    unsigned long long result = 0;
    for (int i = 0; i < 16; i += 2) {
      int double_nibble_count = ((count >> (56 - 4 * i)) & 0xFF);
      result <<= shifting_table[double_nibble_count];
      result |= result_table[double_nibble_count + i * 16 * 8];
    }
    buf[num] = result;
  }
}
