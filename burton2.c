#include "nibble.h"

static unsigned long nibble_sort_word(unsigned long arg) {
  int x;
  int y;
  int arr[16];
  for (int i = 0; i < 16; i++) {
    arr[i] = arg & 0xf;
    arg >>= 4;
  }
  x = arr[0] < arr[1] ? arr[0] : arr[1];
  y = arr[0] < arr[1] ? arr[1] : arr[0];
  arr[0] = x;
  arr[1] = y;
  x = arr[2] < arr[3] ? arr[2] : arr[3];
  y = arr[2] < arr[3] ? arr[3] : arr[2];
  arr[2] = x;
  arr[3] = y;
  x = arr[4] < arr[5] ? arr[4] : arr[5];
  y = arr[4] < arr[5] ? arr[5] : arr[4];
  arr[4] = x;
  arr[5] = y;
  x = arr[6] < arr[7] ? arr[6] : arr[7];
  y = arr[6] < arr[7] ? arr[7] : arr[6];
  arr[6] = x;
  arr[7] = y;
  x = arr[8] < arr[9] ? arr[8] : arr[9];
  y = arr[8] < arr[9] ? arr[9] : arr[8];
  arr[8] = x;
  arr[9] = y;
  x = arr[10] < arr[11] ? arr[10] : arr[11];
  y = arr[10] < arr[11] ? arr[11] : arr[10];
  arr[10] = x;
  arr[11] = y;
  x = arr[12] < arr[13] ? arr[12] : arr[13];
  y = arr[12] < arr[13] ? arr[13] : arr[12];
  arr[12] = x;
  arr[13] = y;
  x = arr[14] < arr[15] ? arr[14] : arr[15];
  y = arr[14] < arr[15] ? arr[15] : arr[14];
  arr[14] = x;
  arr[15] = y;
  x = arr[0] < arr[2] ? arr[0] : arr[2];
  y = arr[0] < arr[2] ? arr[2] : arr[0];
  arr[0] = x;
  arr[2] = y;
  x = arr[4] < arr[6] ? arr[4] : arr[6];
  y = arr[4] < arr[6] ? arr[6] : arr[4];
  arr[4] = x;
  arr[6] = y;
  x = arr[8] < arr[10] ? arr[8] : arr[10];
  y = arr[8] < arr[10] ? arr[10] : arr[8];
  arr[8] = x;
  arr[10] = y;
  x = arr[12] < arr[14] ? arr[12] : arr[14];
  y = arr[12] < arr[14] ? arr[14] : arr[12];
  arr[12] = x;
  arr[14] = y;
  x = arr[1] < arr[3] ? arr[1] : arr[3];
  y = arr[1] < arr[3] ? arr[3] : arr[1];
  arr[1] = x;
  arr[3] = y;
  x = arr[5] < arr[7] ? arr[5] : arr[7];
  y = arr[5] < arr[7] ? arr[7] : arr[5];
  arr[5] = x;
  arr[7] = y;
  x = arr[9] < arr[11] ? arr[9] : arr[11];
  y = arr[9] < arr[11] ? arr[11] : arr[9];
  arr[9] = x;
  arr[11] = y;
  x = arr[13] < arr[15] ? arr[13] : arr[15];
  y = arr[13] < arr[15] ? arr[15] : arr[13];
  arr[13] = x;
  arr[15] = y;
  x = arr[0] < arr[4] ? arr[0] : arr[4];
  y = arr[0] < arr[4] ? arr[4] : arr[0];
  arr[0] = x;
  arr[4] = y;
  x = arr[8] < arr[12] ? arr[8] : arr[12];
  y = arr[8] < arr[12] ? arr[12] : arr[8];
  arr[8] = x;
  arr[12] = y;
  x = arr[1] < arr[5] ? arr[1] : arr[5];
  y = arr[1] < arr[5] ? arr[5] : arr[1];
  arr[1] = x;
  arr[5] = y;
  x = arr[9] < arr[13] ? arr[9] : arr[13];
  y = arr[9] < arr[13] ? arr[13] : arr[9];
  arr[9] = x;
  arr[13] = y;
  x = arr[2] < arr[6] ? arr[2] : arr[6];
  y = arr[2] < arr[6] ? arr[6] : arr[2];
  arr[2] = x;
  arr[6] = y;
  x = arr[10] < arr[14] ? arr[10] : arr[14];
  y = arr[10] < arr[14] ? arr[14] : arr[10];
  arr[10] = x;
  arr[14] = y;
  x = arr[3] < arr[7] ? arr[3] : arr[7];
  y = arr[3] < arr[7] ? arr[7] : arr[3];
  arr[3] = x;
  arr[7] = y;
  x = arr[11] < arr[15] ? arr[11] : arr[15];
  y = arr[11] < arr[15] ? arr[15] : arr[11];
  arr[11] = x;
  arr[15] = y;
  x = arr[0] < arr[8] ? arr[0] : arr[8];
  y = arr[0] < arr[8] ? arr[8] : arr[0];
  arr[0] = x;
  arr[8] = y;
  x = arr[1] < arr[9] ? arr[1] : arr[9];
  y = arr[1] < arr[9] ? arr[9] : arr[1];
  arr[1] = x;
  arr[9] = y;
  x = arr[2] < arr[10] ? arr[2] : arr[10];
  y = arr[2] < arr[10] ? arr[10] : arr[2];
  arr[2] = x;
  arr[10] = y;
  x = arr[3] < arr[11] ? arr[3] : arr[11];
  y = arr[3] < arr[11] ? arr[11] : arr[3];
  arr[3] = x;
  arr[11] = y;
  x = arr[4] < arr[12] ? arr[4] : arr[12];
  y = arr[4] < arr[12] ? arr[12] : arr[4];
  arr[4] = x;
  arr[12] = y;
  x = arr[5] < arr[13] ? arr[5] : arr[13];
  y = arr[5] < arr[13] ? arr[13] : arr[5];
  arr[5] = x;
  arr[13] = y;
  x = arr[6] < arr[14] ? arr[6] : arr[14];
  y = arr[6] < arr[14] ? arr[14] : arr[6];
  arr[6] = x;
  arr[14] = y;
  x = arr[7] < arr[15] ? arr[7] : arr[15];
  y = arr[7] < arr[15] ? arr[15] : arr[7];
  arr[7] = x;
  arr[15] = y;
  x = arr[5] < arr[10] ? arr[5] : arr[10];
  y = arr[5] < arr[10] ? arr[10] : arr[5];
  arr[5] = x;
  arr[10] = y;
  x = arr[6] < arr[9] ? arr[6] : arr[9];
  y = arr[6] < arr[9] ? arr[9] : arr[6];
  arr[6] = x;
  arr[9] = y;
  x = arr[3] < arr[12] ? arr[3] : arr[12];
  y = arr[3] < arr[12] ? arr[12] : arr[3];
  arr[3] = x;
  arr[12] = y;
  x = arr[13] < arr[14] ? arr[13] : arr[14];
  y = arr[13] < arr[14] ? arr[14] : arr[13];
  arr[13] = x;
  arr[14] = y;
  x = arr[7] < arr[11] ? arr[7] : arr[11];
  y = arr[7] < arr[11] ? arr[11] : arr[7];
  arr[7] = x;
  arr[11] = y;
  x = arr[1] < arr[2] ? arr[1] : arr[2];
  y = arr[1] < arr[2] ? arr[2] : arr[1];
  arr[1] = x;
  arr[2] = y;
  x = arr[4] < arr[8] ? arr[4] : arr[8];
  y = arr[4] < arr[8] ? arr[8] : arr[4];
  arr[4] = x;
  arr[8] = y;
  x = arr[1] < arr[4] ? arr[1] : arr[4];
  y = arr[1] < arr[4] ? arr[4] : arr[1];
  arr[1] = x;
  arr[4] = y;
  x = arr[7] < arr[13] ? arr[7] : arr[13];
  y = arr[7] < arr[13] ? arr[13] : arr[7];
  arr[7] = x;
  arr[13] = y;
  x = arr[2] < arr[8] ? arr[2] : arr[8];
  y = arr[2] < arr[8] ? arr[8] : arr[2];
  arr[2] = x;
  arr[8] = y;
  x = arr[11] < arr[14] ? arr[11] : arr[14];
  y = arr[11] < arr[14] ? arr[14] : arr[11];
  arr[11] = x;
  arr[14] = y;
  x = arr[5] < arr[6] ? arr[5] : arr[6];
  y = arr[5] < arr[6] ? arr[6] : arr[5];
  arr[5] = x;
  arr[6] = y;
  x = arr[9] < arr[10] ? arr[9] : arr[10];
  y = arr[9] < arr[10] ? arr[10] : arr[9];
  arr[9] = x;
  arr[10] = y;
  x = arr[2] < arr[4] ? arr[2] : arr[4];
  y = arr[2] < arr[4] ? arr[4] : arr[2];
  arr[2] = x;
  arr[4] = y;
  x = arr[11] < arr[13] ? arr[11] : arr[13];
  y = arr[11] < arr[13] ? arr[13] : arr[11];
  arr[11] = x;
  arr[13] = y;
  x = arr[3] < arr[8] ? arr[3] : arr[8];
  y = arr[3] < arr[8] ? arr[8] : arr[3];
  arr[3] = x;
  arr[8] = y;
  x = arr[7] < arr[12] ? arr[7] : arr[12];
  y = arr[7] < arr[12] ? arr[12] : arr[7];
  arr[7] = x;
  arr[12] = y;
  x = arr[6] < arr[8] ? arr[6] : arr[8];
  y = arr[6] < arr[8] ? arr[8] : arr[6];
  arr[6] = x;
  arr[8] = y;
  x = arr[10] < arr[12] ? arr[10] : arr[12];
  y = arr[10] < arr[12] ? arr[12] : arr[10];
  arr[10] = x;
  arr[12] = y;
  x = arr[3] < arr[5] ? arr[3] : arr[5];
  y = arr[3] < arr[5] ? arr[5] : arr[3];
  arr[3] = x;
  arr[5] = y;
  x = arr[7] < arr[9] ? arr[7] : arr[9];
  y = arr[7] < arr[9] ? arr[9] : arr[7];
  arr[7] = x;
  arr[9] = y;
  x = arr[3] < arr[4] ? arr[3] : arr[4];
  y = arr[3] < arr[4] ? arr[4] : arr[3];
  arr[3] = x;
  arr[4] = y;
  x = arr[5] < arr[6] ? arr[5] : arr[6];
  y = arr[5] < arr[6] ? arr[6] : arr[5];
  arr[5] = x;
  arr[6] = y;
  x = arr[7] < arr[8] ? arr[7] : arr[8];
  y = arr[7] < arr[8] ? arr[8] : arr[7];
  arr[7] = x;
  arr[8] = y;
  x = arr[9] < arr[10] ? arr[9] : arr[10];
  y = arr[9] < arr[10] ? arr[10] : arr[9];
  arr[9] = x;
  arr[10] = y;
  x = arr[11] < arr[12] ? arr[11] : arr[12];
  y = arr[11] < arr[12] ? arr[12] : arr[11];
  arr[11] = x;
  arr[12] = y;
  x = arr[6] < arr[7] ? arr[6] : arr[7];
  y = arr[6] < arr[7] ? arr[7] : arr[6];
  arr[6] = x;
  arr[7] = y;
  x = arr[8] < arr[9] ? arr[8] : arr[9];
  y = arr[8] < arr[9] ? arr[9] : arr[8];
  arr[8] = x;
  arr[9] = y;
  for (int i = 15; i >= 0; i--) {
    arg <<= 4;
    arg |= arr[i];
  }
  return arg;
}

void nibble_sort_burton2(unsigned long *buf) {
  for (int i = 0; i < 1024; i++) {
    buf[i] = nibble_sort_word(buf[i]);
  }
}
